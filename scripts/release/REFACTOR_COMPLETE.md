# GNB ç¼–è¯‘ç³»ç»Ÿæ¨¡å—åŒ–é‡æ„ - å®Œæˆ

## âœ… é‡æ„å®Œæˆï¼

GNB ç¼–è¯‘ç³»ç»Ÿå·²æˆåŠŸé‡æ„ä¸ºæ¨¡å—åŒ–æ¶æ„ï¼ŒåŸå•ä½“è„šæœ¬ï¼ˆ1000+è¡Œï¼‰å·²æ‹†åˆ†ä¸ºå¤šä¸ªèŒè´£å•ä¸€çš„æ¨¡å—ã€‚

## ğŸ“ æ–°çš„æ–‡ä»¶ç»“æ„

```
scripts/release/
â”œâ”€â”€ build_and_upload.sh              # ä¸»å…¥å£ï¼ˆè½»é‡çº§è·¯ç”±å™¨ï¼Œ384è¡Œï¼‰
â”œâ”€â”€ build_openwrt_sdk.sh             # OpenWRT SDK ç¼–è¯‘ï¼ˆåŠ¨æ€é“¾æ¥ï¼Œ273è¡Œï¼‰
â”œâ”€â”€ build_openwrt_musl.sh            # OpenWRT musl ç¼–è¯‘ï¼ˆé™æ€é“¾æ¥ï¼Œ228è¡Œï¼‰
â”œâ”€â”€ build_linux.sh                   # Linux ç¼–è¯‘ï¼ˆGNU gccï¼Œ229è¡Œï¼‰
â”œâ”€â”€ upload.sh                        # ä¸Šä¼ å¤„ç†ï¼ˆ209è¡Œï¼‰
â”œâ”€â”€ install_toolchains.sh            # å·¥å…·é“¾å®‰è£…ï¼ˆä¿æŒä¸å˜ï¼‰
â”œâ”€â”€ sync_to_remote.sh                # åŒæ­¥è„šæœ¬ï¼ˆä¿æŒä¸å˜ï¼‰
â”œâ”€â”€ config.env                       # é…ç½®æ–‡ä»¶
â”œâ”€â”€ config.env.example               # é…ç½®ç¤ºä¾‹
â””â”€â”€ lib/
    â”œâ”€â”€ utils.sh                     # å·¥å…·å‡½æ•°ï¼ˆ70è¡Œï¼‰
    â”œâ”€â”€ toolchain_detection.sh       # å·¥å…·é“¾æ£€æµ‹ï¼ˆ304è¡Œï¼‰
    â””â”€â”€ build_common.sh              # é€šç”¨ç¼–è¯‘å‡½æ•°ï¼ˆ178è¡Œï¼‰
```

**åŸå§‹è„šæœ¬**: 986 è¡Œ
**é‡æ„åæ€»è®¡**: 1875 è¡Œï¼ˆåŒ…å«æ‰€æœ‰æ¨¡å—å’Œæ³¨é‡Šï¼‰
**ä¸»å…¥å£è„šæœ¬**: 384 è¡Œï¼ˆå‡å°‘ 61%ï¼‰
**å¹³å‡æ¯ä¸ªæ¨¡å—**: ~230 è¡Œ

## ğŸ¯ æ¶æ„è®¾è®¡

### 1. **ä¸»å…¥å£è„šæœ¬** (`build_and_upload.sh`)
- è½»é‡çº§è·¯ç”±å™¨ï¼Œè´Ÿè´£å‚æ•°è§£æå’Œä»»åŠ¡åˆ†å‘
- æ ¹æ® `--use-sdk` å‚æ•°å’Œæ¶æ„é€‰æ‹©è°ƒç”¨å¯¹åº”çš„ç¼–è¯‘è„šæœ¬
- å®Œæˆç¼–è¯‘åè‡ªåŠ¨è°ƒç”¨ `upload.sh`
- ä¿æŒå‘åå…¼å®¹ï¼Œæ‰€æœ‰åŸæœ‰å‚æ•°ç»§ç»­å·¥ä½œ

### 2. **ä¸“ç”¨ç¼–è¯‘è„šæœ¬**
- **`build_openwrt_sdk.sh`**: ä½¿ç”¨ OpenWRT SDK åŠ¨æ€é“¾æ¥ç¼–è¯‘
- **`build_openwrt_musl.sh`**: ä½¿ç”¨ç‹¬ç«‹ musl å·¥å…·é“¾é™æ€é“¾æ¥ç¼–è¯‘ï¼ˆæ¨èï¼‰
- **`build_linux.sh`**: ä½¿ç”¨ GNU gcc é™æ€é“¾æ¥ç¼–è¯‘

### 3. **ç‹¬ç«‹ä¸Šä¼ è„šæœ¬** (`upload.sh`)
- å¯å•ç‹¬è¿è¡Œï¼Œæ”¯æŒç‹¬ç«‹ä¸Šä¼ å·²ç¼–è¯‘çš„ç‰ˆæœ¬
- è‡ªåŠ¨ç”Ÿæˆæ ¡éªŒå’Œï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰

### 4. **å‡½æ•°åº“æ¨¡å—** (`lib/`)
- **`utils.sh`**: é€šç”¨å·¥å…·å‡½æ•°ï¼ˆæ‰“å°ã€ä¾èµ–æ£€æŸ¥ã€æ ¡éªŒå’Œç”Ÿæˆï¼‰
- **`toolchain_detection.sh`**: å·¥å…·é“¾æ£€æµ‹å’Œé…ç½®
- **`build_common.sh`**: é€šç”¨ç¼–è¯‘å’Œæ‰“åŒ…å‡½æ•°

## ğŸ“ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•ï¼ˆä¸åŸè„šæœ¬å®Œå…¨å…¼å®¹ï¼‰

```bash
# ç¼–è¯‘æ‰€æœ‰æ¶æ„å¹¶ä¸Šä¼ ï¼ˆé»˜è®¤ï¼šOpenWRT=muslé™æ€ï¼ŒLinux=GNUé™æ€ï¼‰
./build_and_upload.sh ver1.6.0.a

# ä»…ç¼–è¯‘ä¸ä¸Šä¼ 
./build_and_upload.sh --no-upload ver1.6.0.a

# ç¼–è¯‘ç‰¹å®šæ¶æ„
./build_and_upload.sh --arch linux:arm64 --arch openwrt:mips64 ver1.6.0.a

# ä½¿ç”¨ OpenWRT SDKï¼ˆåŠ¨æ€é“¾æ¥ï¼‰
./build_and_upload.sh --use-sdk --sdk-version=23.05 --sdk-abi=hard ver1.6.0.a

# ä»…ä¸Šä¼ å·²ç¼–è¯‘æ–‡ä»¶
./build_and_upload.sh --upload-only ver1.6.0.a
```

### ä½¿ç”¨ä¸“ç”¨ç¼–è¯‘è„šæœ¬

```bash
# OpenWRT musl é™æ€é“¾æ¥ï¼ˆæ¨èï¼‰
./build_openwrt_musl.sh ver1.6.0.a

# OpenWRT SDK åŠ¨æ€é“¾æ¥
./build_openwrt_sdk.sh ver1.6.0.a --sdk-version=23.05 --sdk-abi=hard

# Linux å¹³å°
./build_linux.sh ver1.6.0.a

# ç‹¬ç«‹ä¸Šä¼ 
./upload.sh ver1.6.0.a
```

## ğŸ”„ ç¼–è¯‘ç­–ç•¥è·¯ç”±

ä¸»å…¥å£è„šæœ¬æ ¹æ®ä»¥ä¸‹è§„åˆ™è·¯ç”±åˆ°å¯¹åº”çš„ç¼–è¯‘è„šæœ¬ï¼š

| æ¡ä»¶ | è°ƒç”¨è„šæœ¬ | å·¥å…·é“¾ | é“¾æ¥æ–¹å¼ |
|------|---------|--------|---------|
| `linux:*` æ¶æ„ | `build_linux.sh` | GNU gcc | é™æ€ |
| `openwrt:*` + æ—  `--use-sdk` | `build_openwrt_musl.sh` | musl | é™æ€ |
| `openwrt:*` + `--use-sdk` | `build_openwrt_sdk.sh` | OpenWRT SDK | åŠ¨æ€ |

## âœ¨ æ”¹è¿›ç‚¹

### 1. **ä»£ç å¯ç»´æŠ¤æ€§**
- âœ… å•ä¸ªæ–‡ä»¶ä» 1000+è¡Œ é™ä½åˆ° 200-350è¡Œ
- âœ… èŒè´£å•ä¸€ï¼Œæ˜“äºç†è§£å’Œä¿®æ”¹
- âœ… å‡½æ•°åº“å¤ç”¨ï¼Œå‡å°‘ä»£ç é‡å¤

### 2. **åŠŸèƒ½å®Œå…¨ä¿ç•™**
- âœ… æ‰€æœ‰åŸæœ‰å‚æ•°å’ŒåŠŸèƒ½ç»§ç»­å·¥ä½œ
- âœ… ç¼–è¯‘ç­–ç•¥å®Œå…¨ä¸€è‡´
- âœ… é”™è¯¯æç¤ºå’Œå·¥å…·é“¾æ£€æµ‹é€»è¾‘ä¸å˜

### 3. **çµæ´»æ€§æå‡**
- âœ… å¯ç‹¬ç«‹è¿è¡Œå„ä¸ªç¼–è¯‘è„šæœ¬
- âœ… å¯å•ç‹¬ä¸Šä¼ å·²ç¼–è¯‘ç‰ˆæœ¬
- âœ… ä¾¿äºæ·»åŠ æ–°å¹³å°æ”¯æŒ

### 4. **å‘åå…¼å®¹**
- âœ… ç°æœ‰è°ƒç”¨æ–¹å¼ä¸å—å½±å“
- âœ… ç¯å¢ƒå˜é‡é…ç½®ä¿æŒä¸€è‡´
- âœ… è¾“å‡ºç›®å½•ç»“æ„ä¸å˜

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### å‡½æ•°åº“ä¾èµ–å…³ç³»
```
build_and_upload.sh
    â”œâ”€â”€ lib/utils.sh
    â””â”€â”€ è°ƒç”¨ â†’ build_*.sh
                â”œâ”€â”€ lib/utils.sh
                â”œâ”€â”€ lib/toolchain_detection.sh
                â””â”€â”€ lib/build_common.sh
                        â”œâ”€â”€ lib/utils.sh
                        â””â”€â”€ lib/toolchain_detection.sh

upload.sh
    â””â”€â”€ lib/utils.sh
```

### å…³é”®æ”¹è¿›
1. **æ¨¡å—åŒ–åŠ è½½**: æ¯ä¸ªè„šæœ¬é€šè¿‡ `source` åŠ è½½éœ€è¦çš„å‡½æ•°åº“
2. **ç‹¬ç«‹è¿è¡Œ**: å­è„šæœ¬å¯ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¾èµ–ä¸»å…¥å£
3. **é”™è¯¯éš”ç¦»**: ç¼–è¯‘å¤±è´¥ä¸å½±å“å…¶ä»–æ¶æ„çš„ç¼–è¯‘
4. **æ¸…æ™°è¾“å‡º**: æ¯ä¸ªé˜¶æ®µæœ‰æ˜ç¡®çš„å¼€å§‹/ç»“æŸæ ‡è®°

## ğŸ“¦ å¤‡ä»½è¯´æ˜

åŸå§‹è„šæœ¬å·²å¤‡ä»½ä¸ºï¼š
```
scripts/release/build_and_upload.sh.bak_refactor
```

å¦‚éœ€å›æ»šï¼Œæ‰§è¡Œï¼š
```bash
cd scripts/release
mv build_and_upload.sh build_and_upload.sh.new
mv build_and_upload.sh.bak_refactor build_and_upload.sh
```

## ğŸ§ª æµ‹è¯•å»ºè®®

### 1. åŸºæœ¬åŠŸèƒ½æµ‹è¯•
```bash
# æŸ¥çœ‹å¸®åŠ©
./build_and_upload.sh --help

# æµ‹è¯•å‚æ•°è§£æï¼ˆä¸å®é™…ç¼–è¯‘ï¼‰
./build_and_upload.sh --no-upload --arch linux:amd64 test_version
```

### 2. ç¼–è¯‘æµ‹è¯•
```bash
# æµ‹è¯•å•ä¸ªæ¶æ„ç¼–è¯‘
./build_linux.sh --arch linux:amd64 test_v1.0

# æµ‹è¯• OpenWRT musl
./build_openwrt_musl.sh --arch openwrt:arm64 test_v1.0

# æµ‹è¯•ä¸Šä¼ ï¼ˆéœ€è¦é…ç½® SSHï¼‰
./upload.sh test_v1.0
```

### 3. å®Œæ•´æµç¨‹æµ‹è¯•
```bash
# å®Œæ•´ç¼–è¯‘å’Œä¸Šä¼ æµç¨‹
./build_and_upload.sh --no-upload test_v1.0
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `USAGE.md` - ä½¿ç”¨æ–‡æ¡£
- `TOOLCHAIN_STRUCTURE.md` - å·¥å…·é“¾æ¶æ„è¯´æ˜
- `TOOLCHAIN_COMPARISON.md` - è¯¦ç»†å¯¹æ¯”æ–‡æ¡£
- `config.env.example` - é…ç½®ç¤ºä¾‹

## ğŸ‰ æ€»ç»“

æ¨¡å—åŒ–é‡æ„å·²å®Œæˆï¼æ–°æ¶æ„å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š

1. **æ›´æ˜“ç»´æŠ¤**: ä»£ç ç»“æ„æ¸…æ™°ï¼ŒèŒè´£æ˜ç¡®
2. **æ›´æ˜“æ‰©å±•**: æ·»åŠ æ–°å¹³å°æˆ–æ¶æ„æ”¯æŒæ›´ç®€å•
3. **æ›´æ˜“è°ƒè¯•**: å¯ç‹¬ç«‹æµ‹è¯•å„ä¸ªæ¨¡å—
4. **å®Œå…¨å…¼å®¹**: ä¿æŒå‘åå…¼å®¹ï¼Œç°æœ‰ç”¨æˆ·æ— éœ€ä¿®æ”¹è°ƒç”¨æ–¹å¼

æ„Ÿè°¢æ‚¨çš„ä¿¡ä»»ï¼å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶åé¦ˆã€‚ğŸ’ª
